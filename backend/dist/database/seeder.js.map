{"version":3,"sources":["../../src/database/seeder.ts"],"sourcesContent":["import { drizzle } from \"drizzle-orm/node-postgres\";\r\nimport {\r\n  clinics,\r\n  doctors,\r\n  NewClinic,\r\n  NewDoctor,\r\n  NewStaff,\r\n  staff,\r\n} from \"./schemas/master.schema\";\r\nimport { generateCode } from \"src/utils/generate-code\";\r\nimport { encryptPassword } from \"src/utils/encrypt\";\r\n\r\nasync function seedDatabase() {\r\n  console.log(\"Loading environment variables...\");\r\n  const dbConnectionString = process.env.DB_CONNECTION_STRING;\r\n\r\n  console.log(\"DATABASE_URL:\", dbConnectionString);\r\n\r\n  if (!dbConnectionString) {\r\n    console.error(\"‚ùå Database connection string is missing.\");\r\n    return;\r\n  }\r\n\r\n  console.log(\"‚úÖ Connecting to database...\");\r\n  const database = drizzle(dbConnectionString);\r\n\r\n  console.log(\"üå± Seeding database...\");\r\n\r\n  try {\r\n    const doctorsData: NewDoctor = {\r\n      code: await generateCode(database, doctors, \"code\", \"DTR\"),\r\n      name: \"Dr. Hj. Haryono\",\r\n      dayOfWeek: 5,\r\n      startTime: \"09:00:00\",\r\n      endTime: \"17:00:00\",\r\n      quota: 40,\r\n    };\r\n\r\n    const insertedDoctor = await database\r\n      .insert(doctors)\r\n      .values(doctorsData)\r\n      .returning({\r\n        id: doctors.id,\r\n        code: doctors.code,\r\n        name: doctors.name,\r\n      });\r\n\r\n    console.log(\"Doctor is created:\", insertedDoctor);\r\n\r\n    if (!insertedDoctor) {\r\n      console.error(\"Error seeding doctor:\");\r\n      return;\r\n    }\r\n\r\n    const clinicsData: NewClinic = {\r\n      code: await generateCode(database, clinics, \"code\", \"CLC\"),\r\n      name: \"Poli Kandungan\",\r\n    };\r\n\r\n    const insertedClinic = await database\r\n      .insert(clinics)\r\n      .values(clinicsData)\r\n      .returning({\r\n        id: clinics.id,\r\n        code: clinics.code,\r\n        name: clinics.name,\r\n      });\r\n\r\n    console.log(\"Clinic is created:\", insertedClinic);\r\n\r\n    if (!insertedClinic) {\r\n      console.error(\"Error seeding clinics group:\");\r\n      return;\r\n    }\r\n\r\n    const staffData: NewStaff = {\r\n      code: await generateCode(database, staff, \"code\", \"STF\"),\r\n      loketNumber: \"02\",\r\n      username: \"staff-loket2\",\r\n      email: \"staff2@puribunda.com\",\r\n      password: encryptPassword(\"staff2\"),\r\n      name: \"Holding Company\",\r\n      phone: \"0812343534534\",\r\n      clinicId: insertedClinic[0].id,\r\n      address: \"Badung, Bali, Indonesia\",\r\n    };\r\n\r\n    const insertedStaff = await database\r\n      .insert(staff)\r\n      .values(staffData)\r\n      .returning({\r\n        id: staff.id,\r\n        code: staff.code,\r\n        name: staff.name,\r\n      });\r\n\r\n    console.log(\"Staff created:\", insertedStaff);\r\n\r\n    if (!insertedStaff) {\r\n      console.error(\"Error seeding staff:\");\r\n      return;\r\n    }\r\n  } catch (error) {\r\n    console.error(\"‚ùå Error seeding any data:\", error);\r\n  }\r\n\r\n  console.log(\"üéâ Seeding Finished.\");\r\n}\r\n\r\nseedDatabase();\r\n"],"names":["seedDatabase","console","log","dbConnectionString","process","env","DB_CONNECTION_STRING","error","database","drizzle","doctorsData","code","generateCode","doctors","name","dayOfWeek","startTime","endTime","quota","insertedDoctor","insert","values","returning","id","clinicsData","clinics","insertedClinic","staffData","staff","loketNumber","username","email","password","encryptPassword","phone","clinicId","address","insertedStaff"],"mappings":";;;;8BAAwB;8BAQjB;8BACsB;yBACG;AAEhC,eAAeA;IACbC,QAAQC,GAAG,CAAC;IACZ,MAAMC,qBAAqBC,QAAQC,GAAG,CAACC,oBAAoB;IAE3DL,QAAQC,GAAG,CAAC,iBAAiBC;IAE7B,IAAI,CAACA,oBAAoB;QACvBF,QAAQM,KAAK,CAAC;QACd;IACF;IAEAN,QAAQC,GAAG,CAAC;IACZ,MAAMM,WAAWC,IAAAA,qBAAO,EAACN;IAEzBF,QAAQC,GAAG,CAAC;IAEZ,IAAI;QACF,MAAMQ,cAAyB;YAC7BC,MAAM,MAAMC,IAAAA,0BAAY,EAACJ,UAAUK,qBAAO,EAAE,QAAQ;YACpDC,MAAM;YACNC,WAAW;YACXC,WAAW;YACXC,SAAS;YACTC,OAAO;QACT;QAEA,MAAMC,iBAAiB,MAAMX,SAC1BY,MAAM,CAACP,qBAAO,EACdQ,MAAM,CAACX,aACPY,SAAS,CAAC;YACTC,IAAIV,qBAAO,CAACU,EAAE;YACdZ,MAAME,qBAAO,CAACF,IAAI;YAClBG,MAAMD,qBAAO,CAACC,IAAI;QACpB;QAEFb,QAAQC,GAAG,CAAC,sBAAsBiB;QAElC,IAAI,CAACA,gBAAgB;YACnBlB,QAAQM,KAAK,CAAC;YACd;QACF;QAEA,MAAMiB,cAAyB;YAC7Bb,MAAM,MAAMC,IAAAA,0BAAY,EAACJ,UAAUiB,qBAAO,EAAE,QAAQ;YACpDX,MAAM;QACR;QAEA,MAAMY,iBAAiB,MAAMlB,SAC1BY,MAAM,CAACK,qBAAO,EACdJ,MAAM,CAACG,aACPF,SAAS,CAAC;YACTC,IAAIE,qBAAO,CAACF,EAAE;YACdZ,MAAMc,qBAAO,CAACd,IAAI;YAClBG,MAAMW,qBAAO,CAACX,IAAI;QACpB;QAEFb,QAAQC,GAAG,CAAC,sBAAsBwB;QAElC,IAAI,CAACA,gBAAgB;YACnBzB,QAAQM,KAAK,CAAC;YACd;QACF;QAEA,MAAMoB,YAAsB;YAC1BhB,MAAM,MAAMC,IAAAA,0BAAY,EAACJ,UAAUoB,mBAAK,EAAE,QAAQ;YAClDC,aAAa;YACbC,UAAU;YACVC,OAAO;YACPC,UAAUC,IAAAA,wBAAe,EAAC;YAC1BnB,MAAM;YACNoB,OAAO;YACPC,UAAUT,cAAc,CAAC,EAAE,CAACH,EAAE;YAC9Ba,SAAS;QACX;QAEA,MAAMC,gBAAgB,MAAM7B,SACzBY,MAAM,CAACQ,mBAAK,EACZP,MAAM,CAACM,WACPL,SAAS,CAAC;YACTC,IAAIK,mBAAK,CAACL,EAAE;YACZZ,MAAMiB,mBAAK,CAACjB,IAAI;YAChBG,MAAMc,mBAAK,CAACd,IAAI;QAClB;QAEFb,QAAQC,GAAG,CAAC,kBAAkBmC;QAE9B,IAAI,CAACA,eAAe;YAClBpC,QAAQM,KAAK,CAAC;YACd;QACF;IACF,EAAE,OAAOA,OAAO;QACdN,QAAQM,KAAK,CAAC,6BAA6BA;IAC7C;IAEAN,QAAQC,GAAG,CAAC;AACd;AAEAF"}