{"version":3,"sources":["../../../../src/modules/auth/services/jwt-auth.service.ts"],"sourcesContent":["import { HttpException, HttpStatus, Injectable } from \"@nestjs/common\";\nimport { ConfigService } from \"@nestjs/config\";\nimport * as jwt from \"jsonwebtoken\";\n\n@Injectable()\nexport class JwtAuthService {\n  private readonly tokenSecret: string;\n  private readonly tokenExpiration: number;\n\n  constructor(private readonly configService: ConfigService) {\n    this.tokenSecret = configService.get<string>(\"JWT_ACCESS_TOKEN_SECRET\")!;\n    this.tokenExpiration = configService.get<number>(\n      \"JWT_ACCESS_TOKEN_EXPIRATION_TIME\"\n    )!;\n  }\n\n  async verifyAccessToken<R>(token: string, secret: string): Promise<R> {\n    try {\n      return jwt.verify(token, secret) as R;\n    } catch (err) {\n      throw new HttpException(\n        \"expired or invalid token\",\n        HttpStatus.UNAUTHORIZED\n      );\n    }\n  }\n\n  async generateJwtUser<T, R>(payload: T): Promise<R> {\n    const token = await jwt.sign(payload, this.tokenSecret, {\n      expiresIn: Number(this.tokenExpiration),\n    });\n\n    return {\n      payload,\n      expiresIn: this.tokenExpiration,\n      accessToken: token,\n    } as R;\n  }\n}\n"],"names":["JwtAuthService","verifyAccessToken","token","secret","jwt","verify","err","HttpException","HttpStatus","UNAUTHORIZED","generateJwtUser","payload","sign","tokenSecret","expiresIn","Number","tokenExpiration","accessToken","configService","get"],"mappings":";;;;+BAKaA;;;eAAAA;;;wBALyC;wBACxB;sEACT;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAGd,IAAA,AAAMA,iBAAN,MAAMA;IAWX,MAAMC,kBAAqBC,KAAa,EAAEC,MAAc,EAAc;QACpE,IAAI;YACF,OAAOC,cAAIC,MAAM,CAACH,OAAOC;QAC3B,EAAE,OAAOG,KAAK;YACZ,MAAM,IAAIC,qBAAa,CACrB,4BACAC,kBAAU,CAACC,YAAY;QAE3B;IACF;IAEA,MAAMC,gBAAsBC,OAAU,EAAc;QAClD,MAAMT,QAAQ,MAAME,cAAIQ,IAAI,CAACD,SAAS,IAAI,CAACE,WAAW,EAAE;YACtDC,WAAWC,OAAO,IAAI,CAACC,eAAe;QACxC;QAEA,OAAO;YACLL;YACAG,WAAW,IAAI,CAACE,eAAe;YAC/BC,aAAaf;QACf;IACF;IA5BA,YAAY,AAAiBgB,aAA4B,CAAE;aAA9BA,gBAAAA;QAC3B,IAAI,CAACL,WAAW,GAAGK,cAAcC,GAAG,CAAS;QAC7C,IAAI,CAACH,eAAe,GAAGE,cAAcC,GAAG,CACtC;IAEJ;AAwBF"}