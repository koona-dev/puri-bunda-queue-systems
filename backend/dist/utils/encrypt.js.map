{"version":3,"sources":["../../src/utils/encrypt.ts"],"sourcesContent":["import \"dotenv/config\";\r\nimport * as jwt from \"jsonwebtoken\";\r\nimport * as bcrypt from \"bcryptjs\";\r\nimport * as crypto from \"crypto\";\r\n\r\nexport const encryptPassword = (password: string) => {\r\n  return bcrypt.hashSync(password, 12);\r\n};\r\n\r\nexport const comparePassword = (hashPassword: string, password: string) => {\r\n  return bcrypt.compareSync(password, hashPassword);\r\n};\r\n\r\nexport const generateToken = (payload: string) => {\r\n  return jwt.sign(payload, process.env.JWT_ACCESS_TOKEN_SECRET!, {\r\n    expiresIn: \"1d\",\r\n  });\r\n};\r\n\r\nexport const generateRandomString = (length = 128) => {\r\n  // Generate enough random bytes, then slice to desired length\r\n  return crypto\r\n    .randomBytes(length)\r\n    .toString(\"base64\") // or \"hex\"\r\n    .slice(0, length); // ensure max length\r\n};\r\n\r\nexport const generateSha256Base64 = (data: string) => {\r\n  let jsonStringHash256 = crypto\r\n    .createHash(\"sha256\")\r\n    .update(data, \"utf-8\")\r\n    .digest();\r\n\r\n  let bufferFromJsonStringHash256 = Buffer.from(jsonStringHash256);\r\n  return bufferFromJsonStringHash256.toString(\"base64\");\r\n};\r\n\r\nexport const generateHmacSha256Base64 = (\r\n  data: { [key: string]: any },\r\n  secret: string\r\n) => {\r\n  // Create an HMAC object using SHA256 algorithm and the secret key\r\n  const hmac = crypto\r\n    .createHmac(\"sha256\", secret)\r\n    .update(data.toString())\r\n    .digest();\r\n\r\n  // Calculate the digest and encode it in Base64\r\n  let bufferFromHmac256Value = Buffer.from(hmac);\r\n  return bufferFromHmac256Value.toString(\"base64\");\r\n};\r\n"],"names":["comparePassword","encryptPassword","generateHmacSha256Base64","generateRandomString","generateSha256Base64","generateToken","password","bcrypt","hashSync","hashPassword","compareSync","payload","jwt","sign","process","env","JWT_ACCESS_TOKEN_SECRET","expiresIn","length","crypto","randomBytes","toString","slice","data","jsonStringHash256","createHash","update","digest","bufferFromJsonStringHash256","Buffer","from","secret","hmac","createHmac","bufferFromHmac256Value"],"mappings":";;;;;;;;;;;QASaA;eAAAA;;QAJAC;eAAAA;;QAgCAC;eAAAA;;QAlBAC;eAAAA;;QAQAC;eAAAA;;QAdAC;eAAAA;;;QAbN;sEACc;kEACG;gEACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEjB,MAAMJ,kBAAkB,CAACK;IAC9B,OAAOC,UAAOC,QAAQ,CAACF,UAAU;AACnC;AAEO,MAAMN,kBAAkB,CAACS,cAAsBH;IACpD,OAAOC,UAAOG,WAAW,CAACJ,UAAUG;AACtC;AAEO,MAAMJ,gBAAgB,CAACM;IAC5B,OAAOC,cAAIC,IAAI,CAACF,SAASG,QAAQC,GAAG,CAACC,uBAAuB,EAAG;QAC7DC,WAAW;IACb;AACF;AAEO,MAAMd,uBAAuB,CAACe,SAAS,GAAG;IAC/C,6DAA6D;IAC7D,OAAOC,QACJC,WAAW,CAACF,QACZG,QAAQ,CAAC,UAAU,WAAW;KAC9BC,KAAK,CAAC,GAAGJ,SAAS,oBAAoB;AAC3C;AAEO,MAAMd,uBAAuB,CAACmB;IACnC,IAAIC,oBAAoBL,QACrBM,UAAU,CAAC,UACXC,MAAM,CAACH,MAAM,SACbI,MAAM;IAET,IAAIC,8BAA8BC,OAAOC,IAAI,CAACN;IAC9C,OAAOI,4BAA4BP,QAAQ,CAAC;AAC9C;AAEO,MAAMnB,2BAA2B,CACtCqB,MACAQ;IAEA,kEAAkE;IAClE,MAAMC,OAAOb,QACVc,UAAU,CAAC,UAAUF,QACrBL,MAAM,CAACH,KAAKF,QAAQ,IACpBM,MAAM;IAET,+CAA+C;IAC/C,IAAIO,yBAAyBL,OAAOC,IAAI,CAACE;IACzC,OAAOE,uBAAuBb,QAAQ,CAAC;AACzC"}