{"version":3,"sources":["../../../src/utils/guards/role.guard.ts"],"sourcesContent":["import { CanActivate, ExecutionContext, Injectable } from \"@nestjs/common\";\r\nimport { Reflector } from \"@nestjs/core\";\r\n\r\n@Injectable()\r\nexport class RolesGuard implements CanActivate {\r\n  constructor(private reflector: Reflector) {} // â¬… Inject Reflector\r\n\r\n  canActivate(ctx: ExecutionContext): boolean {\r\n    const roles = this.reflector.get<string[]>(\"roles\", ctx.getHandler());\r\n    if (!roles) return true; // endpoint tanpa @Roles -> allow\r\n\r\n    const request = ctx.switchToHttp().getRequest();\r\n    const user = request.user;\r\n    return roles.includes(user.role);\r\n  }\r\n}\r\n"],"names":["RolesGuard","canActivate","ctx","roles","reflector","get","getHandler","request","switchToHttp","getRequest","user","includes","role"],"mappings":";;;;+BAIaA;;;eAAAA;;;wBAJ6C;sBAChC;;;;;;;;;;AAGnB,IAAA,AAAMA,aAAN,MAAMA;IAGXC,YAAYC,GAAqB,EAAW;QAC1C,MAAMC,QAAQ,IAAI,CAACC,SAAS,CAACC,GAAG,CAAW,SAASH,IAAII,UAAU;QAClE,IAAI,CAACH,OAAO,OAAO,MAAM,iCAAiC;QAE1D,MAAMI,UAAUL,IAAIM,YAAY,GAAGC,UAAU;QAC7C,MAAMC,OAAOH,QAAQG,IAAI;QACzB,OAAOP,MAAMQ,QAAQ,CAACD,KAAKE,IAAI;IACjC;IATA,YAAY,AAAQR,SAAoB,CAAE;aAAtBA,YAAAA;IAAuB;AAU7C"}